import{w as F,v as S,a as $}from"./runtime-dom.esm-bundler.BEzqyxp1.js";import{c as v,o as y,d as J,a,b as Q,w as x,e as C,t as G,n as Y,r as f,f as X,g as Z}from"./runtime-core.esm-bundler.mmfGiYl5.js";/* empty css                          */import{_ as ee}from"./_plugin-vue_export-helper.DlAUqK2U.js";class k{constructor(e=0,s="Network Error"){this.status=e,this.text=s}}const te=()=>{if(!(typeof localStorage>"u"))return{get:t=>Promise.resolve(localStorage.getItem(t)),set:(t,e)=>Promise.resolve(localStorage.setItem(t,e)),remove:t=>Promise.resolve(localStorage.removeItem(t))}},l={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:te()},L=t=>t?typeof t=="string"?{publicKey:t}:t.toString()==="[object Object]"?t:{}:{},se=(t,e="https://api.emailjs.com")=>{if(!t)return;const s=L(t);l.publicKey=s.publicKey,l.blockHeadless=s.blockHeadless,l.storageProvider=s.storageProvider,l.blockList=s.blockList,l.limitRate=s.limitRate,l.origin=s.origin||e},T=async(t,e,s={})=>{const i=await fetch(l.origin+t,{method:"POST",headers:s,body:e}),o=await i.text(),c=new k(i.status,o);if(i.ok)return c;throw c},V=(t,e,s)=>{if(!t||typeof t!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!e||typeof e!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!s||typeof s!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},ie=t=>{if(t&&t.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},H=t=>t.webdriver||!t.languages||t.languages.length===0,B=()=>new k(451,"Unavailable For Headless Browser"),re=(t,e)=>{if(!Array.isArray(t))throw"The BlockList list has to be an array";if(typeof e!="string")throw"The BlockList watchVariable has to be a string"},ae=t=>!t.list?.length||!t.watchVariable,oe=(t,e)=>t instanceof FormData?t.get(e):t[e],O=(t,e)=>{if(ae(t))return!1;re(t.list,t.watchVariable);const s=oe(e,t.watchVariable);return typeof s!="string"?!1:t.list.includes(s)},A=()=>new k(403,"Forbidden"),ne=(t,e)=>{if(typeof t!="number"||t<0)throw"The LimitRate throttle has to be a positive number";if(e&&typeof e!="string")throw"The LimitRate ID has to be a non-empty string"},le=async(t,e,s)=>{const i=Number(await s.get(t)||0);return e-Date.now()+i},D=async(t,e,s)=>{if(!e.throttle||!s)return!1;ne(e.throttle,e.id);const i=e.id||t;return await le(i,e.throttle,s)>0?!0:(await s.set(i,Date.now().toString()),!1)},q=()=>new k(429,"Too Many Requests"),ce=async(t,e,s,i)=>{const o=L(i),c=o.publicKey||l.publicKey,n=o.blockHeadless||l.blockHeadless,u=o.storageProvider||l.storageProvider,w={...l.blockList,...o.blockList},h={...l.limitRate,...o.limitRate};return n&&H(navigator)?Promise.reject(B()):(V(c,t,e),ie(s),s&&O(w,s)?Promise.reject(A()):await D(location.pathname,h,u)?Promise.reject(q()):T("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:c,service_id:t,template_id:e,template_params:s}),{"Content-type":"application/json"}))},de=t=>{if(!t||t.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"},he=t=>typeof t=="string"?document.querySelector(t):t,pe=async(t,e,s,i)=>{const o=L(i),c=o.publicKey||l.publicKey,n=o.blockHeadless||l.blockHeadless,u=l.storageProvider||o.storageProvider,w={...l.blockList,...o.blockList},h={...l.limitRate,...o.limitRate};if(n&&H(navigator))return Promise.reject(B());const g=he(s);V(c,t,e),de(g);const m=new FormData(g);return O(w,m)?Promise.reject(A()):await D(location.pathname,h,u)?Promise.reject(q()):(m.append("lib_version","4.4.1"),m.append("service_id",t),m.append("template_id",e),m.append("user_id",c),T("/api/v1.0/email/send-form",m))},ue={init:se,send:ce,sendForm:pe,EmailJSResponseStatus:k},I="hcaptcha-api-script-id",K="_hcaptchaOnLoad";let R,M;const E=new Promise((t,e)=>{R=t,M=e});function me(t){if(window.hcaptcha)return R(),E;if(document.getElementById(I))return E;window[K]=R;const e=fe(t),s=document.createElement("script");return s.id=I,s.src=e,s.async=!0,s.defer=!0,s.onerror=i=>{console.error("Failed to load api: "+e,i),M("Failed to load api.js")},document.head.appendChild(s),E}function fe(t){let e=t.apiEndpoint;return e=p(e,"render","explicit"),e=p(e,"onload",K),e=p(e,"recaptchacompat",t.reCaptchaCompat===!1?"off":null),e=p(e,"hl",t.language),e=p(e,"sentry",t.sentry),e=p(e,"custom",t.custom),e=p(e,"endpoint",t.endpoint),e=p(e,"assethost",t.assethost),e=p(e,"imghost",t.imghost),e=p(e,"reportapi",t.reportapi),e}function p(t,e,s){if(s!=null){const i=t.includes("?")?"&":"?";return t+i+e+"="+encodeURIComponent(s)}return t}var ge=(t,e)=>{for(const[s,i]of e)t[s]=i;return t};const be={name:"VueHcaptcha",props:{sitekey:{type:String,required:!0},theme:{type:String,default:void 0},size:{type:String,default:void 0},tabindex:{type:String,default:void 0},language:{type:String,default:void 0},reCaptchaCompat:{type:Boolean,default:!0},challengeContainer:{type:String,default:void 0},rqdata:{type:String,default:void 0},sentry:{type:Boolean,default:!0},custom:{type:Boolean,default:void 0},apiEndpoint:{type:String,default:"https://hcaptcha.com/1/api.js"},endpoint:{type:String,default:void 0},reportapi:{type:String,default:void 0},assethost:{type:String,default:void 0},imghost:{type:String,default:void 0}},data:()=>({widgetId:null,hcaptcha:null,renderedCb:null}),mounted(){return me(this.$props).then(this.onApiLoaded).catch(this.onError)},unmounted(){this.teardown()},destroyed(){this.teardown()},methods:{teardown(){this.widgetId&&(this.hcaptcha.reset(this.widgetId),this.hcaptcha.remove(this.widgetId))},onApiLoaded(){this.hcaptcha=window.hcaptcha;const t={sitekey:this.sitekey,theme:this.theme,size:this.size,tabindex:this.tabindex,callback:this.onVerify,"expired-callback":this.onExpired,"chalexpired-callback":this.onChallengeExpired,"error-callback":this.onError,"open-callback":this.onOpen,"close-callback":this.onClose};this.challengeContainer&&(t["challenge-container"]=this.challengeContainer),this.widgetId=this.hcaptcha.render(this.$el,t),this.rqdata&&this.hcaptcha.setData(this.widgetId,{rqdata:this.rqdata}),this.onRendered()},execute(){this.widgetId?(this.hcaptcha.execute(this.widgetId),this.onExecuted()):this.renderedCb=()=>{this.renderedCb=null,this.execute()}},executeAsync(){if(this.widgetId)return this.onExecuted(),this.hcaptcha.execute(this.widgetId,{async:!0});let t;const e=new Promise(s=>{t=s});return this.renderedCb=()=>{this.renderedCb=null,t()},e.then(this.executeAsync)},reset(){this.widgetId?(this.hcaptcha.reset(this.widgetId),this.onReset()):this.$emit("error","Element is not rendered yet and thus cannot reset it. Wait for `rendered` event to safely call reset.")},onRendered(){this.$emit("rendered"),this.renderedCb&&this.renderedCb()},onExecuted(){this.$emit("executed")},onReset(){this.$emit("reset")},onError(t){this.$emit("error",t),this.reset()},onVerify(){const t=this.hcaptcha.getResponse(this.widgetId),e=this.hcaptcha.getRespKey(this.widgetId);this.$emit("verify",t,e)},onExpired(){this.$emit("expired")},onChallengeExpired(){this.$emit("challengeExpired")},onOpen(){this.$emit("opened")},onClose(){this.$emit("closed")}}},ve={id:"hcap-script"};function ye(t,e,s,i,o,c){return y(),v("div",ve)}var we=ge(be,[["render",ye]]);const ke=J({__name:"FormPopup",setup(t,{expose:e}){e();const s=f(!1),i=f(!1),o=f(!1),c=f(""),n=f(null),u=f(null),w="d9b2e78c-9f48-4190-9754-170e4866054e",h=f({name:"",phone:"",message:"",agree:!1});function g(){s.value=!0,i.value=!1,c.value="",h.value.name="",h.value.phone="",h.value.message="",h.value.agree=!1}function m(){s.value=!1}function N(P){let b=P.target.value;const z=b.startsWith("+");let r=b.replace(/\D/g,""),d="";z?(d="+",r.startsWith("7")&&(r=r.slice(1),d+="7",r.length>0&&(d+=" ("+r.slice(0,3)),r.length>=4&&(d+=") "+r.slice(3,6)),r.length>=7&&(d+="-"+r.slice(6,8)),r.length>=9&&(d+="-"+r.slice(8,10)))):(r.startsWith("8")?r="7"+r.slice(1):r.startsWith("9")?r="79"+r.slice(1):r.startsWith("7")||(r="7"+r),d="+7",r.length>1&&(d+=" ("+r.slice(1,4)),r.length>=5&&(d+=") "+r.slice(4,7)),r.length>=8&&(d+="-"+r.slice(7,9)),r.length>=10&&(d+="-"+r.slice(9,11))),h.value.phone=d}async function U(P){if(n.value){o.value=!0,c.value="";try{new FormData(n.value).append("h-captcha-response",P),await ue.sendForm("service_wq0jqrd","template_24xrd1c",n.value,"QYVFG3lrU2_gp6O9u"),i.value=!0,n.value.reset(),u.value.reset()}catch(b){c.value=`❌ Ошибка: ${b.text||b.message}`}finally{o.value=!1}}}function W(){if(!h.value.agree){c.value="⚠️ Пожалуйста, дайте согласие на обработку данных";return}u.value&&u.value.execute()}const _=()=>g();X(()=>{window.addEventListener("open-contact-popup",_)}),Z(()=>{window.removeEventListener("open-contact-popup",_)});const j={isOpen:s,success:i,loading:o,status:c,formRef:n,hcaptchaRef:u,siteKey:w,form:h,openPopup:g,closePopup:m,formatPhone:N,sendEmail:U,submitForm:W,handleOpen:_,get VueHcaptcha(){return we}};return Object.defineProperty(j,"__isScriptSetup",{enumerable:!1,value:!0}),j}}),xe={class:"popup"},_e={key:0,class:"success-state"},Pe={class:"custom-checkbox"},Se=["disabled"],Ce={key:0,class:"spinner"},Ee={key:1},Re={class:"status"};function Le(t,e,s,i,o,c){return y(),v("div",{class:Y(["popup-overlay",{active:i.isOpen}]),onClick:F(i.closePopup,["self"])},[a("div",xe,[a("button",{class:"popup-close-btn",onClick:i.closePopup,"aria-label":"Close"},e[4]||(e[4]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round","stroke-linejoin":"round"},[a("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])),i.success?(y(),v("div",_e,e[5]||(e[5]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"tick",viewBox:"0 0 24 24"},[a("path",{fill:"none",stroke:"green","stroke-width":"3",d:"M5 13l4 4L19 7"})],-1),a("h2",null,"Спасибо за вашу заявку!",-1),a("p",null,"Свяжемся с вами в ближайшее время.",-1)]))):(y(),v("form",{key:1,ref:"formRef",onSubmit:F(i.submitForm,["prevent"])},[Q(i.VueHcaptcha,{ref:"hcaptchaRef",sitekey:i.siteKey,size:"invisible",theme:"dark",onVerify:i.sendEmail},null,8,["sitekey"]),e[8]||(e[8]=a("h2",null,"Консультация и замер - бесплатно",-1)),e[9]||(e[9]=a("a",{href:"https://t.me/MultiAgent_io",class:"text-blue telegram-link",target:"_blank"},[a("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor"},[a("path",{d:"m12 24c6.629 0 12-5.371 12-12s-5.371-12-12-12-12 5.371-12 12 5.371 12 12 12zm-6.509-12.26 11.57-4.461c.537-.194 1.006.131.832.943l.001-.001-1.97 9.281c-.146.658-.537.818-1.084.508l-3-2.211-1.447 1.394c-.16.16-.295.295-.605.295l.213-3.053 5.56-5.023c.242-.213-.054-.333-.373-.121l-6.871 4.326-2.962-.924c-.643-.204-.657-.643.136-.953z"})]),a("b",null,"Напишите нам в Telegram")],-1)),e[10]||(e[10]=a("p",{class:"text-small"},"или",-1)),e[11]||(e[11]=a("p",null,"Воспользуйтесь формой обратной связи",-1)),x(a("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>i.form.name=n),type:"text",name:"name",placeholder:"Ваше имя",required:""},null,512),[[S,i.form.name]]),x(a("input",{"onUpdate:modelValue":e[1]||(e[1]=n=>i.form.phone=n),type:"tel",name:"phone",placeholder:"+7 (___) ___-____",onInput:i.formatPhone,required:""},null,544),[[S,i.form.phone]]),x(a("textarea",{"onUpdate:modelValue":e[2]||(e[2]=n=>i.form.message=n),name:"message",placeholder:"Комментарий"},null,512),[[S,i.form.message]]),a("label",Pe,[x(a("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=n=>i.form.agree=n)},null,512),[[$,i.form.agree]]),e[6]||(e[6]=a("span",{class:"checkmark"},null,-1)),e[7]||(e[7]=a("span",null,[C(" Я даю свое согласие на обработку "),a("a",{href:"/terms",target:"_blank",class:"link underline","aria-label":"Узнать больше об условиях использования"},"персональных данных"),C(" и соглашаюсь с условиями и "),a("a",{href:"/privacy-policy",target:"_blank",class:"link underline","aria-label":"Узнать больше о политике конфиденциальности"},"политикой конфиденциальности"),C(".")],-1))]),a("button",{type:"submit",disabled:i.loading||!i.form.agree},[i.loading?(y(),v("span",Ce)):(y(),v("span",Ee,"Отправить"))],8,Se),a("p",Re,G(i.status),1)],544))])],2)}const Ve=ee(ke,[["render",Le],["__scopeId","data-v-b99a87b1"]]);export{Ve as default};
